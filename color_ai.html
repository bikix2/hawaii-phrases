<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ¨ AIãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ã‚«ãƒ©ãƒ¼è¨ºæ–­</title>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            /* ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼ã‚’å°‘ã—ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«ã«å¤‰æ›´ã—ã¦è‰²ã‚’è¦‹ã‚„ã™ã */
            --primary: #E0AAFF;
            --accent: #FFD700;
            --bg: #1a1a1a; 
            --card-bg: rgba(255, 255, 255, 0.08);
            --text: #ffffff;
        }
        
        body {
            font-family: 'Shippori Mincho', serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2c2c2c 100%);
            margin: 0; padding: 20px;
            color: var(--text); min-height: 100vh;
        }

        .container { max-width: 600px; margin: 0 auto; text-align: center; padding-bottom: 80px; }

        h1 {
            color: var(--primary); font-size: 1.8rem; margin: 10px 0 15px 0;
            text-shadow: 0 0 15px rgba(224, 170, 255, 0.4);
        }

        /* ç”»åƒæ  */
        .upload-wrapper { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; margin-top: 30px;}
        .upload-box {
            position: relative; width: 70%; max-width: 320px; aspect-ratio: 3/4;
            border: 3px dashed var(--primary); border-radius: 20px;
            background: rgba(0,0,0,0.3); display: flex; flex-direction: column;
            justify-content: center; align-items: center; cursor: pointer; overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.05); transition: transform 0.2s;
        }
        .upload-box:active { transform: scale(0.98); }
        .preview-img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; display: none; }
        .upload-icon { font-size: 3rem; margin-bottom: 10px; opacity: 1.0; text-shadow: 0 0 10px var(--primary); }
        .upload-label { font-size: 1rem; font-weight: bold; color: #fff; }

        /* èª¬æ˜ */
        .instruction-text {
            background: rgba(255, 255, 255, 0.1); border: 1px solid var(--primary);
            color: #ddd; padding: 15px; border-radius: 10px;
            font-size: 0.9rem; margin-bottom: 15px; text-align: left;
        }
        .instruction-text strong { color: var(--accent); }

        /* ãƒœã‚¿ãƒ³ */
        .btn-main {
            background: linear-gradient(45deg, #E0AAFF, #C77dFF); color: #1a0b2e; border: none; padding: 15px 50px;
            font-size: 1.2rem; font-weight: bold; border-radius: 50px; cursor: pointer;
            box-shadow: 0 0 20px rgba(224, 170, 255, 0.4); width: 100%; margin-top: 10px;
        }
        .btn-main:disabled { background: #555; color: #aaa; box-shadow: none; }

        .control-btns { display: none; gap: 10px; margin-top: 20px; justify-content: center; }
        .btn-control {
            background: rgba(255,255,255,0.1); border: 1px solid #999; color: #fff;
            padding: 12px 20px; border-radius: 30px; cursor: pointer; font-size: 0.95rem; flex: 1; max-width: 140px;
            font-weight: bold;
        }

        #result-wrapper { display: none; animation: fadeIn 0.5s ease; text-align: left; }
        
        /* çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .result-header { text-align: center; margin-bottom: 20px; }
        .season-badge {
            display: inline-block; padding: 10px 30px; border-radius: 50px;
            font-size: 2rem; font-weight: bold; margin: 10px 0;
            background: #fff; color: #000; box-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        .fortune-card {
            background: var(--card-bg); border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px; padding: 15px; margin-bottom: 15px;
        }
        .card-title { font-weight: bold; color: var(--primary); border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 8px; margin-bottom: 10px; display: block;}
        
        /* ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆè¡¨ç¤º */
        .color-palette { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-bottom: 10px; }
        .color-swatch { 
            width: 60px; height: 60px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.5); 
            box-shadow: 0 4px 6px rgba(0,0,0,0.3); position: relative;
        }
        .color-code {
            position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%);
            font-size: 0.7rem; color: #ccc; font-family: sans-serif; background: rgba(0,0,0,0.5); padding: 2px 4px; border-radius: 4px;
        }

        ul { margin: 0; padding-left: 20px; color: #eee; font-size: 0.95rem; }
        li { margin-bottom: 5px; line-height: 1.6; }

        .action-btns { display: flex; gap: 10px; margin-top: 20px; }
        .btn-sub { flex: 1; padding: 12px; border-radius: 10px; border: none; cursor: pointer; font-weight: bold; }
        .btn-save { background: #00b894; color: white; }
        .btn-retry { background: #636e72; color: white; }

        .loading-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(26,26,26,0.95); z-index:100; display:none; justify-content:center; align-items:center; flex-direction:column; }
        .loading-icon { font-size: 4rem; animation: spin 2s infinite linear; margin-bottom: 20px; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0.5; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .modal { display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 3000; justify-content: center; align-items: center; }
        .modal-content { background: #2c2c2c; padding: 30px; border-radius: 20px; width: 85%; border: 1px solid var(--primary); text-align: center; }
        .input-key { width: 90%; padding: 12px; margin: 20px 0; background: #1a1a1a; color: white; border: 1px solid var(--primary); border-radius: 5px; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="key-modal" class="modal">
    <div class="modal-content">
        <h2>ğŸ”‘ APIè¨­å®š</h2>
        <p>Gemini APIã‚­ãƒ¼ã‚’å…¥åŠ›</p>
        <input type="password" id="api-key-input" class="input-key" placeholder="API Key">
        <button class="btn-main" onclick="saveApiKey()">OK</button>
    </div>
</div>

<div id="loading" class="loading-overlay">
    <div class="loading-icon">ğŸ¨</div>
    <div class="loading-msg" id="loading-msg">è‚Œã®è‰²ã€ç³ã®è‰²ã‚’åˆ†æä¸­...</div>
</div>

<div class="container">
    <h1>ğŸ¨ AIãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ã‚«ãƒ©ãƒ¼è¨ºæ–­</h1>
    
    <div id="settings-area">
        <div class="instruction-text">
            <strong>ğŸ“¸ æ’®å½±ã®ã‚³ãƒ„</strong><br>
            ãƒ»ãƒãƒ¼ãƒ¡ã‚¤ã‚¯ã€ã¾ãŸã¯ãƒŠãƒãƒ¥ãƒ©ãƒ«ãƒ¡ã‚¤ã‚¯ã§ã€‚<br>
            ãƒ»è‡ªç„¶å…‰ï¼ˆæ˜ã‚‹ã„çª“éš›ï¼‰ã§æ’®å½±ã™ã‚‹ã¨ç²¾åº¦ãŒä¸ŠãŒã‚Šã¾ã™ã€‚<br>
            ãƒ»é¡”å…¨ä½“ãŒæ˜ã‚‹ãå†™ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
        </div>
    </div>

    <div class="upload-wrapper" id="upload-wrapper">
        <div class="upload-box" id="box1" onclick="triggerFile()">
            <div id="ph1">
                <div class="upload-icon">ğŸ“·</div>
                <div class="upload-label" id="label1">ã‚¿ãƒƒãƒ—ã—ã¦æ’®å½±/é¸æŠ</div>
            </div>
            <img id="preview1" class="preview-img">
        </div>
    </div>

    <input type="file" id="file-input" accept="image/*" capture="user" style="display:none" onchange="handleFileSelect(this)">
    
    <button id="analyze-btn" class="btn-main" onclick="startAnalysis()" disabled>è¨ºæ–­ã™ã‚‹</button>

    <div class="control-btns" id="post-capture-btns">
        <button class="btn-control" onclick="resetAll()">ğŸ  æˆ»ã‚‹</button>
        <button class="btn-control" onclick="triggerFile()">ğŸ”„ æ’®ã‚Šç›´ã™</button>
    </div>

    <div id="result-wrapper">
        <div id="capture-target" style="background: #1a1a1a; padding: 20px; border-radius: 15px;">
            <div class="result-header">
                <div style="color:#aaa; font-size:0.9rem;">ã‚ãªãŸã®ãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ã‚«ãƒ©ãƒ¼ã¯...</div>
                <div id="result-season" class="season-badge">Analyzing...</div>
                <div style="font-size:0.8rem; color:#888; margin-top:5px;" id="result-desc"></div>
            </div>

            <div class="fortune-card">
                <span class="card-title">âœ¨ ã‚ãªãŸã«ä¼¼åˆã†ãƒ™ã‚¹ãƒˆã‚«ãƒ©ãƒ¼</span>
                <div class="color-palette" id="best-colors">
                    </div>
            </div>

            <div id="result-content"></div>
        </div>

        <div class="action-btns">
            <button class="btn-sub btn-retry" onclick="location.reload()">æœ€åˆã«æˆ»ã‚‹</button>
            <button class="btn-sub btn-save" onclick="saveResultImage()">ç”»åƒã‚’ä¿å­˜ ğŸ“¸</button>
        </div>
    </div>
</div>

<script>
    let API_KEY = "";
    const GEMINI_MODEL = "gemini-2.0-flash-exp"; // é«˜é€Ÿã§è¦–è¦šèªè­˜ã«å¼·ã„ãƒ¢ãƒ‡ãƒ«æ¨å¥¨
    let imgBase64 = null;

    window.onload = function() {
        checkApiKey();
    };

    function checkApiKey() {
        const stored = localStorage.getItem('gemini_api_key_color');
        if (stored) { API_KEY = stored; document.getElementById('key-modal').classList.add('hidden'); }
    }
    function saveApiKey() {
        const key = document.getElementById('api-key-input').value.trim();
        if (key) { API_KEY = key; localStorage.setItem('gemini_api_key_color', key); document.getElementById('key-modal').classList.add('hidden'); }
    }

    function triggerFile() {
        document.getElementById('file-input').click();
    }

    function handleFileSelect(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) { processImage(e.target.result); };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function processImage(originalBase64) {
        const img = new Image();
        img.onload = function() {
            // ç”»åƒåœ§ç¸®å‡¦ç†ï¼ˆAPIè»¢é€é‡å‰Šæ¸›ï¼‰
            const canvas = document.createElement('canvas');
            let w = img.width, h = img.height;
            const max = 1000;
            if (w > h) { if (w > max) { h *= max/w; w = max; } } else { if (h > max) { w *= max/h; h = max; } }
            canvas.width = w; canvas.height = h;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, w, h);
            const b64 = canvas.toDataURL('image/jpeg', 0.85);

            document.getElementById('preview1').src = b64;
            document.getElementById('preview1').style.display = 'block';
            document.getElementById('ph1').style.display = 'none';

            imgBase64 = b64;
            checkReady();
        };
        img.src = originalBase64;
    }

    function checkReady() {
        const btn = document.getElementById('analyze-btn');
        const postBtns = document.getElementById('post-capture-btns');
        const settings = document.getElementById('settings-area');

        if (imgBase64) {
            btn.disabled = false;
            settings.style.display = 'none';
            postBtns.style.display = 'flex';
        }
    }

    function resetAll() { location.reload(); }

    // === æ•‘æ¸ˆç”¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ ===
    function generateFallbackResult() {
        return {
            season: "Spring (ã‚¤ã‚¨ãƒ™æ˜¥)",
            description: "æ˜ã‚‹ãå…ƒæ°—ã§ã€é€æ˜æ„Ÿã®ã‚ã‚‹æ˜¥ã‚¿ã‚¤ãƒ—ã€‚",
            best_colors: [
                { hex: "#FF7F50", name: "ã‚³ãƒ¼ãƒ©ãƒ«" },
                { hex: "#F4C430", name: "ã‚µãƒ•ãƒ©ãƒ³" },
                { hex: "#98FB98", name: "è‹¥è‰è‰²" },
                { hex: "#FFE4E1", name: "ã‚·ã‚§ãƒ«ãƒ”ãƒ³ã‚¯" }
            ],
            skin_analysis: ["è‚Œè‰²ã¯æ˜ã‚‹ã‚ã®ã‚ªãƒ¼ã‚¯ãƒ«ç³»", "è¡€è‰²ãŒã‚ˆããƒ„ãƒ¤ãŒã‚ã‚‹"],
            makeup: ["ãƒ„ãƒ¤è‚Œã‚’æ´»ã‹ã™ãƒ™ãƒ¼ã‚¹ãƒ¡ã‚¤ã‚¯", "ã‚³ãƒ¼ãƒ©ãƒ«ãƒ”ãƒ³ã‚¯ã®ãƒªãƒƒãƒ—"],
            fashion: ["æ˜ã‚‹ã„ãƒ™ãƒ¼ã‚¸ãƒ¥ã‚„ã‚­ãƒ£ãƒ¡ãƒ«ãŒåŸºæœ¬", "ã‚´ãƒ¼ãƒ«ãƒ‰ã®ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼"],
            message: "å†™çœŸè§£æãŒé›£ã—ã‹ã£ãŸãŸã‚ã€ä¸€èˆ¬çš„ãªSpringã‚¿ã‚¤ãƒ—ã¨ã—ã¦è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚ã‚‚ã£ã¨æ˜ã‚‹ã„å ´æ‰€ã§æ’®å½±ã—ã¦ã¿ã¦ãã ã•ã„ã€‚"
        };
    }

    async function startAnalysis() {
        const btn = document.getElementById('analyze-btn');
        const postBtns = document.getElementById('post-capture-btns');
        const loading = document.getElementById('loading');
        btn.disabled = true;
        postBtns.style.display = 'none';
        loading.style.display = 'flex';

        const b64 = imgBase64.replace(/^data:image\/\w+;base64,/, "");

        // â˜… AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼šãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ã‚«ãƒ©ãƒ¼ã‚¢ãƒŠãƒªã‚¹ãƒˆ
        const prompt = `
        ã‚ãªãŸã¯ãƒ—ãƒ­ã®ãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ã‚«ãƒ©ãƒ¼ã‚¢ãƒŠãƒªã‚¹ãƒˆã§ã™ã€‚
        æ·»ä»˜ã•ã‚ŒãŸé¡”å†™çœŸã‚’åˆ†æã—ã€ä»¥ä¸‹ã®4ã‚·ãƒ¼ã‚ºãƒ³åˆ†é¡ã‹ã‚‰æœ€ã‚‚é©åˆ‡ãªã‚‚ã®ã‚’è¨ºæ–­ã—ã¦ãã ã•ã„ã€‚
        ã€åˆ†é¡ã€‘
        1. Spring (ã‚¤ã‚¨ãƒ™æ˜¥)
        2. Summer (ãƒ–ãƒ«ãƒ™å¤)
        3. Autumn (ã‚¤ã‚¨ãƒ™ç§‹)
        4. Winter (ãƒ–ãƒ«ãƒ™å†¬)

        ä»¥ä¸‹ã®å½¢å¼ã®JSONã®ã¿ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚Markdownã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã¯ä¸è¦ã§ã™ã€‚
        
        {
            "season": "è¨ºæ–­çµæœã®ã‚·ãƒ¼ã‚ºãƒ³åï¼ˆä¾‹: Summer (ãƒ–ãƒ«ãƒ™å¤)ï¼‰",
            "description": "ãã®ã‚·ãƒ¼ã‚ºãƒ³ã®ç‰¹å¾´ã‚’ä¸€è¨€ã§ï¼ˆ20æ–‡å­—ä»¥å†…ï¼‰",
            "best_colors": [
                {"hex": "#ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰", "name": "è‰²å"},
                {"hex": "#ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰", "name": "è‰²å"},
                {"hex": "#ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰", "name": "è‰²å"},
                {"hex": "#ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰", "name": "è‰²å"}
            ],
            "skin_analysis": ["è‚Œã®ç‰¹å¾´1", "ç³ã®è‰²ã‚„é«ªè‰²ã®ç‰¹å¾´2"],
            "makeup": ["ãƒ¡ã‚¤ã‚¯ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹1", "ã‚¢ãƒ‰ãƒã‚¤ã‚¹2"],
            "fashion": ["ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹1", "ã‚¢ãƒ‰ãƒã‚¤ã‚¹2"],
            "message": "ç·åˆçš„ãªåŠ±ã¾ã—ã®ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆ80æ–‡å­—ä»¥å†…ï¼‰"
        }
        
        æ³¨æ„ï¼š
        - ä¼¼åˆã†è‰²(best_colors)ã¯å¿…ãš4è‰²é¸å®šã—ã€å…·ä½“çš„ãªHEXã‚³ãƒ¼ãƒ‰ã‚’å«ã‚ã¦ãã ã•ã„ã€‚
        - è¾›å£ã§ã‚ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªä¿¡ã‚’æŒã¦ã‚‹ã‚ˆã†ãªãƒˆãƒ¼ãƒ³ã§è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚
        `;

        try {
            const contents = [{ parts: [{ text: prompt }, { inline_data: { mime_type: "image/jpeg", data: b64 } }] }];

            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: contents,
                    safetySettings: [
                        { category: "HARM_CATEGORY_HARASSMENT", threshold: "BLOCK_NONE" },
                        { category: "HARM_CATEGORY_DANGEROUS_CONTENT", threshold: "BLOCK_NONE" }
                    ]
                })
            });

            const data = await response.json();
            const text = data.candidates?.[0]?.content?.parts?.[0]?.text;
            
            let res = {};
            try {
                // JSONæŠ½å‡ºã®å¼·åŒ–
                const jsonStr = text.match(/\{[\s\S]*\}/)?.[0];
                res = JSON.parse(jsonStr);
            } catch (e) {
                console.warn("JSON Parse failed, using fallback");
                res = generateFallbackResult();
            }

            // UIåæ˜ 
            document.getElementById('result-season').innerText = res.season;
            document.getElementById('result-season').style.color = getSeasonColor(res.season);
            document.getElementById('result-desc').innerText = res.description;

            // ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆç”Ÿæˆ
            const paletteDiv = document.getElementById('best-colors');
            paletteDiv.innerHTML = res.best_colors.map(c => `
                <div class="color-swatch" style="background:${c.hex}">
                    <div class="color-code">${c.name}</div>
                </div>
            `).join('');

            // å„ç¨®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ
            let html = "";
            html += createTextCard("ğŸ‘© è‚Œãƒ»ç³ãƒ»é«ªã®ç‰¹å¾´", res.skin_analysis);
            html += createTextCard("ğŸ’„ ãƒ¡ã‚¤ã‚¯ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹", res.makeup);
            html += createTextCard("ğŸ‘— ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹", res.fashion);
            html += `<div style="background:rgba(255,255,255,0.1); padding:15px; border-radius:10px; margin-top:15px;"><strong>ğŸ’Œ Message:</strong> ${res.message}</div>`;

            document.getElementById('result-content').innerHTML = html;
            
            // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('upload-wrapper').style.display = 'none';
            btn.style.display = 'none';
            document.getElementById('result-wrapper').style.display = 'block';
            document.getElementById('result-wrapper').scrollIntoView({behavior: 'smooth'});

        } catch (e) {
            console.error(e);
            alert("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚APIã‚­ãƒ¼ã‚’ç¢ºèªã™ã‚‹ã‹ã€ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
            postBtns.style.display = 'flex';
            btn.disabled = false;
        } finally {
            loading.style.display = 'none';
        }
    }

    function getSeasonColor(seasonStr) {
        if(seasonStr.includes("Spring") || seasonStr.includes("æ˜¥")) return "#FF7F50";
        if(seasonStr.includes("Summer") || seasonStr.includes("å¤")) return "#87CEEB";
        if(seasonStr.includes("Autumn") || seasonStr.includes("ç§‹")) return "#DAA520";
        if(seasonStr.includes("Winter") || seasonStr.includes("å†¬")) return "#4169E1";
        return "#333";
    }

    function createTextCard(title, points) {
        return `
        <div class="fortune-card">
            <span class="card-title">${title}</span>
            <ul>${points.map(p => `<li>${p}</li>`).join('')}</ul>
        </div>`;
    }

    function saveResultImage() {
        const target = document.getElementById("capture-target");
        // ä¿å­˜æ™‚ã«è¦‹åˆ‡ã‚Œãªã„ã‚ˆã†ã«ä¸€æ™‚çš„ã«ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´
        const originalStyle = target.style.cssText;
        target.style.width = "500px"; 
        
        html2canvas(target, { backgroundColor: "#1a1a1a", scale: 2 }).then(canvas => {
            const link = document.createElement("a");
            link.href = canvas.toDataURL("image/png");
            link.download = `personal_color_${new Date().getTime()}.png`;
            link.click();
            target.style.cssText = originalStyle; // å…ƒã«æˆ»ã™
        });
    }
</script>
</body>
</html>